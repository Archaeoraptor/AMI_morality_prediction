SELECT DISTINCT
	SUBJECT_ID,
	MAX(VALUEUOM) MAX_VALUE,
	MIN(VALUEUOM) MIN_VALUE
FROM
	(
	SELECT
		CHARTEVENTS.SUBJECT_ID,
		CHARTEVENTS.ICUSTAY_ID,
		CHARTEVENTS.CHARTTIME,
		CHARTEVENTS.`VALUE`,
		CHARTEVENTS.VALUEUOM,
		CHARTEVENTS.ERROR,
		TIMESTAMPDIFF( HOUR, T.INTIME, CHARTEVENTS.CHARTTIME ) STAYHOUR 
	FROM
		CHARTEVENTS,
		A_AKF_DEATH T 
	WHERE
		CHARTEVENTS.ICUSTAY_ID = T.ICUSTAY_ID 
		AND ( CHARTEVENTS.ITEMID = 220546 OR CHARTEVENTS.ITEMID = 1542 )
	ORDER BY
		CHARTEVENTS.SUBJECT_ID 
	) AA
WHERE
	STAYHOUR <= 24 
GROUP BY
	SUBJECT_ID 